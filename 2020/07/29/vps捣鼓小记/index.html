<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <meta 
    name="viewport"
    content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <meta 
    http-equiv="X-UA-Compatible" 
    content="ie=edge">
  <meta 
    name="theme-color" 
    content="#fff" 
    id="theme-color">
  <meta 
    name="description" 
    content="潜空间">
  <link 
    rel="icon" 
    href="/">
  <title>VPS 捣鼓小记</title>
  
    
      <meta 
        property="og:title" 
        content="VPS 捣鼓小记">
    
    
      <meta 
        property="og:url" 
        content="http://blog.779911.xyz/2020/07/29/vps%E6%8D%A3%E9%BC%93%E5%B0%8F%E8%AE%B0/index.html">
    
    
      <meta 
        property="og:img" 
        content="https://img.songhn.com/img/Y67gdd.png">
    
    
    
      <meta 
        property="og:type" 
        content="article">
      <meta 
        property="og:article:published_time" 
        content="2020-07-29">
      <meta 
        property="og:article:modified_time" 
        content="2023-03-15">
      <meta 
        property="og:article:author" 
        content="潜">
      
        
          <meta 
            property="og:article:tag" 
            content="资源">
        
      
    
  
  
  <link rel="preload" href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css" as="style" >
  <link rel="preload" href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css" as="style" >
  <link rel="preload" href="/css/main.css" as="style" >
  
  <link rel="modulepreload" href="//instant.page/5.1.0">
  
  <link rel="stylesheet" href="/css/main.css">
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css">
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css">
  
  
  
    <link rel="stylesheet" href="/js/lib/lightbox/baguetteBox.min.css">
  
  <script>
    function loadScript(url, cb) {
      var script = document.createElement('script');
      script.src = url;
      if (cb) script.onload = cb;
      script.async = true;
      document.body.appendChild(script);
    }
    function loadCSS(href, data, attr) {
      var sheet = document.createElement('link');
      sheet.ref = 'stylesheet';
      sheet.href = href;
      sheet.dataset[data] = attr;
      document.head.appendChild(sheet);
    }
    function changeCSS(cssFile, data, attr) {
      var oldlink = document.querySelector(data);
      var newlink = document.createElement("link");
      newlink.setAttribute("rel", "stylesheet");
      newlink.setAttribute("href", cssFile);
      newlink.dataset.prism = attr;
      document.head.replaceChild(newlink, oldlink);
    }
  </script>
  
    
  
  <script>
    // control reverse button
    var reverseDarkList = {
      dark: 'light',
      light: 'dark'
    };
    var themeColor = {
      dark: '#1c1c1e',
      light: '#fff'
    }
    // get the data of css prefers-color-scheme
    var getCssMediaQuery = function() {
      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    };
    // reverse current darkmode setting function
    var reverseDarkModeSetting = function() {
      var setting = localStorage.getItem('user-color-scheme');
      if(reverseDarkList[setting]) {
        setting = reverseDarkList[setting];
      } else if(setting === null) {
        setting = reverseDarkList[getCssMediaQuery()];
      } else {
        return;
      }
      localStorage.setItem('user-color-scheme', setting);
      return setting;
    };
    // apply current darkmode setting
  </script>
  
    <script>
      var setDarkmode = function(mode) {
      var setting = mode || localStorage.getItem('user-color-scheme');
      if(setting === getCssMediaQuery()) {
        document.documentElement.removeAttribute('data-user-color-scheme');
        localStorage.removeItem('user-color-scheme');
        document.getElementById('theme-color').content = themeColor[setting];
        document.getElementById('theme-color').dataset.mode = setting;
      } else if(reverseDarkList[setting]) {
        document.documentElement.setAttribute('data-user-color-scheme', setting);
        document.getElementById('theme-color').content = themeColor[setting];
        document.getElementById('theme-color').dataset.mode = setting;
      } else {
        document.documentElement.removeAttribute('data-user-color-scheme');
        localStorage.removeItem('user-color-scheme');
        document.getElementById('theme-color').content = themeColor[getCssMediaQuery()];
        document.getElementById('theme-color').dataset.mode = getCssMediaQuery();
      }
    };
    setDarkmode();
    </script>
  
  
  
    <link rel="preload" href="/js/lib/lightbox/baguetteBox.min.js" as="script">
    <link rel="preload" href="/js/lib/lightbox/baguetteBox.min.css" as="style" >
  
  
    <link rel="preload" href="/js/lib/lozad.min.js" as="script">
  
  
  
  
  
  
<meta name="generator" content="Hexo 6.3.0"></head>

  <body>
    <div class="wrapper">
       
      <nav class="navbar">
  <div class="navbar-logo">
    <a class="navbar-logo-main" href="/">
      
      <span class="navbar-logo-dsc">潜空间</span>
      </a>
  </div>
  <div class="navbar-menu">
    
      <a 
        href="/" 
        class="navbar-menu-item">
        
          Home
        
      </a>
    
      <a 
        href="/archives" 
        class="navbar-menu-item">
        
          Archive
        
      </a>
    
      <a 
        href="/tags" 
        class="navbar-menu-item">
        
          Tags
        
      </a>
    
      <a 
        href="/categories" 
        class="navbar-menu-item">
        
          Categories
        
      </a>
    
      <a 
        href="/about" 
        class="navbar-menu-item">
        
          About
        
      </a>
    
      <a 
        href="/links" 
        class="navbar-menu-item">
        
          Friends
        
      </a>
    
    <button 
      class="navbar-menu-item darknavbar navbar-menu-btn" 
      aria-label="Toggle dark mode"
      id="dark">
      <i class="iconfont icon-weather"></i>
    </button>
    <button 
      class="navbar-menu-item searchnavbar navbar-menu-btn" 
      aria-label="Toggle search"
      id="search">
      <!-- <i 
        class="iconfont icon-search" 
        style="font-size: 1.2rem; font-weight: 400;">
      </i> -->
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img"
        class="iconify iconify--ion" width="28" height="28" preserveAspectRatio="xMidYMid meet" viewBox="0 0 512 512">
        <path fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="28"
          d="M256 80a176 176 0 1 0 176 176A176 176 0 0 0 256 80Z"></path>
        <path fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="28"
          d="M232 160a72 72 0 1 0 72 72a72 72 0 0 0-72-72Z"></path>
        <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="28"
          d="M283.64 283.64L336 336"></path>
      </svg>
    </button>
  </div>
</nav> 
      
      <div 
        id="local-search" 
        style="display: none">
        <input
          class="navbar-menu-item"
          id="search-input"
          placeholder="请输入搜索内容..." />
        <div id="search-content"></div>
      </div>
      
      <div class="section-wrap">
        <div class="container">
          <div class="columns">
            <aside class="left-column">
              
              <div class="card card-author">
                
  <img 
    src="https://img.songhn.com/img/Y67gdd.png" 
    class="author-img"
    width="88"
    height="88"
    alt="author avatar">

<p class="author-name">潜</p>
<p class="author-description">designed by theme-kaze</p>
<div class="author-message">
  <a 
    class="author-posts-count" 
    href="/archives">
    <span>86</span>
    <span>Posts</span>
  </a>
  <a 
    class="author-categories-count" 
    href="/categories">
    <span>7</span>
    <span>Categories</span>
  </a>
  <a 
    class="author-tags-count" 
    href="/tags">
    <span>4</span>
    <span>Tags</span>
  </a>
</div>

              </div>
               <div class="sticky-tablet">
  
  
    <article class="display-when-two-columns spacer">
      <div class="card card-content toc-card">
        <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>TOC
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%8E%E8%B4%AD%E4%B9%B0%E4%B8%80%E4%B8%AA-VPS-%E5%BC%80%E5%A7%8B"><span class="toc-text">从购买一个 VPS 开始</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%AE%9E%E6%88%98%EF%BC%8C%E8%AF%95%E6%89%8B-VPS-%E8%BF%81%E7%A7%BB"><span class="toc-text">快速实战，试手 VPS 迁移</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VPS-%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB"><span class="toc-text">VPS 数据迁移</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VPS-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%B8%8E%E6%81%A2%E5%A4%8D"><span class="toc-text">VPS 环境搭建与恢复</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%9A%E5%AE%A2%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%80%E5%8D%95%E4%BC%98%E5%8C%96"><span class="toc-text">博客服务器简单优化</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VPS-%E6%95%B0%E6%8D%AE%E8%A6%81%E5%A4%87%E4%BB%BD%E5%A4%87%E4%BB%BD%E5%A4%87%E4%BB%BD%EF%BC%81"><span class="toc-text">VPS 数据要备份备份备份！</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#cron-%E8%87%AA%E5%8A%A8%E6%89%A7%E8%A1%8C%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1"><span class="toc-text">cron 自动执行定时任务</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%8D%E8%BE%93%E5%85%A5%E5%B8%90%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BD%BF%E7%94%A8-git-pull-x2F-push"><span class="toc-text">免输入帐号密码使用 git pull&#x2F;push</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-VPS-%E5%81%9A%E6%A2%AF%E5%AD%90%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%EF%BC%9F"><span class="toc-text">使用 VPS 做梯子科学上网？</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-pptpd-%E6%90%AD%E5%BB%BA-VPN"><span class="toc-text">安装 pptpd 搭建 VPN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-shadowsocks"><span class="toc-text">安装 shadowsocks</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VPS-%E6%8A%98%E8%85%BE%E6%80%BB%E7%BB%93"><span class="toc-text">VPS 折腾总结</span></a></li></ol>
      </div>
    </article>
  
  
  <article class="card card-content categories-widget">
    <div class="categories-card">
  <div class="categories-header">
    <i 
      class="iconfont icon-fenlei" 
      style="padding-right: 2px;">
    </i>Categories
  </div>
  <div class="categories-list">
    
      <a href="/categories/%E6%91%84%E5%BD%B1/">
        <div class="categories-list-item">
          摄影
          <span class="categories-list-item-badge">3</span>
        </div>
      </a>
    
      <a href="/categories/%E8%AF%BB%E4%B9%A6/">
        <div class="categories-list-item">
          读书
          <span class="categories-list-item-badge">24</span>
        </div>
      </a>
    
      <a href="/categories/VPS/">
        <div class="categories-list-item">
          VPS
          <span class="categories-list-item-badge">26</span>
        </div>
      </a>
    
      <a href="/categories/%E5%85%B6%E4%BB%96/">
        <div class="categories-list-item">
          其他
          <span class="categories-list-item-badge">8</span>
        </div>
      </a>
    
      <a href="/categories/MY/">
        <div class="categories-list-item">
          MY
          <span class="categories-list-item-badge">6</span>
        </div>
      </a>
    
      <a href="/categories/%E4%BA%A7%E5%93%81/">
        <div class="categories-list-item">
          产品
          <span class="categories-list-item-badge">8</span>
        </div>
      </a>
    
      <a href="/categories/%E9%9A%8F%E6%83%B3/">
        <div class="categories-list-item">
          随想
          <span class="categories-list-item-badge">1</span>
        </div>
      </a>
    
  </div>
</div>
  </article>
  
  <article class="card card-content tags-widget">
    <div class="tags-card">
  <div class="tags-header">
    <i 
      class="iconfont icon-biaoqian" 
      style="padding-right: 2px;">
    </i>hot tags
  </div>
  <div class="tags-list">
    
      <a 
        href="/tags/%E7%AC%94%E8%AE%B0/" 
        title="笔记">
        <div class="tags-list-item">笔记</div>
      </a>
    
      <a 
        href="/tags/%E8%B5%84%E6%BA%90/" 
        title="资源">
        <div class="tags-list-item">资源</div>
      </a>
    
      <a 
        href="/tags/%E7%95%AA%E7%BE%BD/" 
        title="番羽">
        <div class="tags-list-item">番羽</div>
      </a>
    
      <a 
        href="/tags/%E7%94%9F%E6%B4%BB/" 
        title="生活">
        <div class="tags-list-item">生活</div>
      </a>
    
  </div>
</div>
  </article>
  
  
</div>
            </aside>
            <main class="main-column">
              
<article class="card card-content">
  <header>
    <h1 class="post-title">
      VPS 捣鼓小记
    </h1>
  </header>
  <div class="post-meta post-show-meta">
    <time datetime="2020-07-29T10:21:30.000Z">
      <i 
        class="iconfont icon-calendar" 
        style="margin-right: 2px;">
      </i>
      <span>2020-07-29</span>
    </time>
    
      <span class="dot"></span>
      
        <a 
          href="/categories/VPS/" 
          class="post-meta-link">
          VPS
        </a>
      
    
    
      <span class="dot"></span>
      <span>4.2k words</span>
    
  </div>
  
    <div 
      class="post-meta post-show-meta" 
      style="margin-top: -10px;">
      <div style="display: flex; align-items: center;">
        <i 
          class="iconfont icon-biaoqian" 
          style="margin-right: 2px; font-size: 1.15rem;">
        </i>
        
          
          <a 
            href="/tags/%E8%B5%84%E6%BA%90/" 
            class="post-meta-link">
            资源
          </a>
        
      </div>
    </div>
  
  </header>
  <div 
    id="section" 
    class="post-content">
    <blockquote>
<p>不作死就不会死， 不捣鼓就不会活 – via 菲利克斯·肖恩莱特</p>
</blockquote>
<p>什么是作死？作死就是不懂原理乱写代码，不懂环境乱配，不懂工具乱用，打掉一个 bug 再怀上一个 bug，伤元气瞎折腾。</p>
<p>什么是捣鼓？捣鼓和作死相反，在解决问题时力求寻因导果，既能解决问题，又能学到新知识拓展新视野。</p>
<p>在最近折腾 VPS 的时候，我就不断在作死，才捣鼓出了新乐趣，写下来和大家分享一下。</p>
<p>作为一个没有服务器端编程经验的小前端，为何要去折腾 VPS 呢？因为能学到很多东西啊，举几个栗子:</p>
<ul>
<li>搭建个博客写点文章啊</li>
<li>既然搭建博客了，那要搞域名啊、CDN啊、加缓存啊、打补丁啊、流量分析啊、性能分析啊、写主题啊、优化访问速度啊、提高 SEO 啊</li>
<li>搭建个 VPN&#x2F;shadowsock 配个代理锻炼锻炼身体又能科学上网啊，还可能省点钱啊</li>
<li>哎呀好多操作都是 Linux 还是纯命令行操作的，能学到不少 Linux 知识啊</li>
<li>女朋友不陪你折腾你还可以折腾 VPS 啊</li>
</ul>
<h1 id="从购买一个-VPS-开始"><a href="#从购买一个-VPS-开始" class="headerlink" title="从购买一个 VPS 开始"></a><strong>从购买一个 VPS 开始</strong></h1><p>要过情人节，首先你得上淘宝买个不会漏气的女朋友。</p>
<p>同理，你想折腾 VPS 你得买个靠谱的服务器。</p>
<p>比如，你想访问速度快一些，可以选择购买腾讯云或阿里云提供的服务器；如果你想更自由一些，可以选择国外 Linode 或者 DigitalOcean 等提供的服务器。选择腾讯云可以使用<a target="_blank" rel="noopener" href="http://www.qcloud.com/redirect.php?redirect=1001&cps_key=50b46969b6fa53f1334070ccf5a941d0">我们的推荐链接</a>, 选择 Linode 则可以使用<a target="_blank" rel="noopener" href="https://www.linode.com/?r=e815823fd4ebad47aef51ae07250b626d30b7f40">这个链接</a>。腾讯云最低配只需 65块，Linode最低配也只需要10美金，具体的配置和价格，可以自己去仔细对比下。</p>
<p>好了，有了充气娃娃，噢不，是服务器，我们就可以放心地上了。</p>
<p>使用 ssh 进行登录，假定服务提供商给你的 IP 是 11.22.33.44, 帐号是 root, 密码是 passwd：</p>
<p>$ ssh <a href="mailto:&#114;&#x6f;&#x6f;&#116;&#64;&#49;&#x31;&#x2e;&#x32;&#50;&#x2e;&#51;&#51;&#46;&#52;&#52;">&#114;&#x6f;&#x6f;&#116;&#64;&#49;&#x31;&#x2e;&#x32;&#50;&#x2e;&#51;&#51;&#46;&#52;&#52;</a></p>
<p>输入密码，第一次登录后建立公钥，我们就和成功上到了服务器。</p>
<p>接着要怎么玩呢？什么姿势舒服就怎么玩嘛。</p>
<p>好了，文章到此结束，我回家找女朋友了。</p>
<p>————我是回家的分界线————</p>
<p>快递还没到，我先上一下 VPS 玩一玩好了。</p>
<h1 id="快速实战，试手-VPS-迁移"><a href="#快速实战，试手-VPS-迁移" class="headerlink" title="快速实战，试手 VPS 迁移"></a><strong>快速实战，试手 VPS 迁移</strong></h1><p>哎呀~ 想起不少人吐槽过我们团队的 <a target="_blank" rel="noopener" href="http://www.alloyteam.com/">博客</a> 打开速度太慢了，都超过了 12 秒，这怎么能忍？</p>
<p>没办法，忍辱负重，我只能趁女朋友还没到之前，快速优化一下（希望 12 秒内可以解决）。</p>
<p>嗯，先分析下博客为什么访问那么慢？</p>
<ol>
<li>服务器在国外，国内连接过去太远了！</li>
<li>使用的是 Wordpress 程序，安装了不少冗余插件！</li>
<li>HTTP 请求数量太多了，就和女生上厕所一样，得排队才能完啊！</li>
<li>Google Analytics 等一些服务器已经被墙！</li>
<li>用户上传图片太大，没有经过压缩处理！</li>
</ol>
<p>好吧，那我们就先进行初步的优化。</p>
<h1 id="VPS-数据迁移"><a href="#VPS-数据迁移" class="headerlink" title="VPS 数据迁移"></a><strong>VPS 数据迁移</strong></h1><p>服务器搬家到国内，也就是 Linode 别人家搬回自己家腾讯云，得带上老老少少一家人：</p>
<ul>
<li>网站代码</li>
<li>Nginx 配置</li>
<li>数据库数据</li>
</ul>
<p>嗯，学到的第一个 linux 终于派上了用场，将这些数据打包：</p>
<p><code>// tar 将文件进行打包</code></p>
<p><code>// -c 表示创建归档</code></p>
<p><code>// -z 表示使用 gzip 压缩</code></p>
<p><code>// -v 表示打包时显示进度</code></p>
<p><code>// -f 指定压缩后的文件名，如 all.tar.gz</code></p>
<p>$ tar -czvf all.tar.gz &#x2F;path&#x2F;to&#x2F;sites &#x2F;path&#x2F;to&#x2F;nginx.conf &#x2F;path&#x2F;to&#x2F;database</p>
<p>好了，数据量不小，打包后的文件非常大，问题就来了，选哪个交通工具呢？</p>
<ul>
<li>wget 或 curl 简单便携</li>
<li>ftp 也是简单便携</li>
<li>scp 加密传输</li>
<li>rsync 增量传输</li>
<li>dropbox 中转传输</li>
</ul>
<p>wget 或 curl 和 ftp 下载的方式很简单。</p>
<p>scp 和 rsync下载的方式是加密传输，也常用于两个主机之间进行复制文件（需要先建立 ssh 连接）。</p>
<p>scp 使用加密进行传输，可以在两个主机中进行复制：</p>
<p>&#x2F;&#x2F; 先登录 A 主机后，将 B 主机 11.22.33.44 上的 &#x2F;home&#x2F;data&#x2F; 复制到 A 主机下的 &#x2F;home&#x2F;data&#x2F;</p>
<p>&#x2F;&#x2F; -r 表示遍历复制目录下的所有文件</p>
<p>$ scp -r <a href="mailto:&#x72;&#x6f;&#111;&#x74;&#64;&#49;&#49;&#46;&#50;&#50;&#x2e;&#51;&#x33;&#46;&#x34;&#x34;">&#x72;&#x6f;&#111;&#x74;&#64;&#49;&#49;&#46;&#50;&#50;&#x2e;&#51;&#x33;&#46;&#x34;&#x34;</a>:&#x2F;home&#x2F;data&#x2F; &#x2F;home&#x2F;data&#x2F;</p>
<p>&#x2F;&#x2F; 若为建立 ssh 连接，则输入后需要输入 A 主机的登录密码</p>
<p>rsync 传输也加密，但能将文件夹、文件等的权限等信息也保存下来，采用流式传输，同时是一种增量备份的算法在支持，效率较高：</p>
<p><code>// 先登录 A 主机后，将 B 主机 11.22.33.44 上的 /home/data/ 复制到 A 主机下的 /home/data/</code></p>
<p><code>// -a 表示使用归档模式，保持所有文件属性</code></p>
<p><code>// -v 表示显示传输进度</code></p>
<p><code>// -r 表示遍历复制目录下的所有文件</code></p>
<p><code>// -z 表示进行压缩处理</code></p>
<p><code>// -e 指定一些端口信息</code></p>
<p>$ rsync -avrz -e ‘ssh -p 22’ <a href="mailto:&#x72;&#x6f;&#x6f;&#116;&#x40;&#x31;&#49;&#x2e;&#50;&#50;&#x2e;&#x33;&#x33;&#x2e;&#x34;&#x34;">&#x72;&#x6f;&#x6f;&#116;&#x40;&#x31;&#49;&#x2e;&#50;&#50;&#x2e;&#x33;&#x33;&#x2e;&#x34;&#x34;</a>:&#x2F;home&#x2F;data &#x2F;home&#x2F;data&#x2F;</p>
<p>嗯，小结一下：</p>
<ul>
<li>对于单次传输来看，可以使用 wget&#x2F;curl&#x2F;ftp;</li>
<li>对于重要数据，可以使用 scp 来传输;</li>
<li>如果有日常备份的需要，可以使用 rsync 来传输（增量备份）;</li>
</ul>
<p>然后，在这次搬家中，这些工具都没什么卵用，腾讯云和 Linode 就像情侣，终究输给了距离：国内外物理距离太远了，都只有几K&#x2F;s的传输速度，说什么距离不是问题山盟海誓爱你加密都没用。</p>
<p>感情出现危机，自然就需要云备胎作为支持。</p>
<p>也就是使用 Dropbox 或百度云进行中转。</p>
<p><a target="_blank" rel="noopener" href="https://www.dropbox.com/developers/apps">Dropbox</a> 服务器也在国外，果真是和 Linode 近水楼台先得月，传输速度高达 5M&#x2F;s, 正当腾讯云准备好一切将一家老少迎接回家时，却又被判了死刑：Dropbox 再高再帅再快也在墙外啊，门不当户不对你们不可以结婚！这时候还有个 <a target="_blank" rel="noopener" href="https://github.com/houtianze/bypy">bypy</a> 的百度云第三方接口可以舒缓下情绪，可这个接口非官方支持，不确定是否可靠，不可作为长期的备份方案，我也无力再爱，所以也没再出轨。</p>
<p>这个故事告诉我们，生活就是如此无奈，我们活在别人界定的环境里，不让你玩你就是不能玩！</p>
<p>等到我们下一代出生时，他们已然不知道这世界上有谷歌、推特、脸书，只有我们知道我们自由的圈子越来越小。</p>
<p>扯远了，回到正题。</p>
<p>既然数据已经在了 Dropbox 中转区，数据搬迁也是一次性的，索性就停止了作死，使用 sftp 将压缩包下载到了本地，同样再使用 sftp 将数据上传到了新服务器上。</p>
<h1 id="VPS-环境搭建与恢复"><a href="#VPS-环境搭建与恢复" class="headerlink" title="VPS 环境搭建与恢复"></a><strong>VPS 环境搭建与恢复</strong></h1><p>接着的事情就简单了，新服务器上恢复环境。</p>
<ul>
<li>安装好所需要的工具（如 Nginx&#x2F;Mysql&#x2F;PHP&#x2F;Git 等)</li>
</ul>
<p>$ apt-get install nginx mysql-server mysql-client php5-fpm</p>
<ul>
<li>配置好所需要的用户和权限</li>
</ul>
<p>添加用户：</p>
<p><code>// 添加新用户 laixiaolai</code></p>
<p>$ useradd laixiaolai</p>
<p><code>// 给新用户设置密码</code></p>
<p>$ passwd ***********</p>
<p>添加用户组：</p>
<p>$ groupadd handsomeboys</p>
<p><code>// 将 laixiaolai 加入这个用户组</code></p>
<p>$ usermod -G handsomeboys laixiaolai</p>
<p>设置一些目录的归属：</p>
<p><code>// 授予 laixiaolai 一个池塘</code></p>
<p>$ chown -R laixiaolai:handsomeboys &#x2F;data&#x2F;girlpool</p>
<p>有趣吧，在 linux VPS 下，自己掌控用户和权限的感觉，好像我这一匹野马拥有了一个草原呐~</p>
<ul>
<li>恢复数据库备份</li>
</ul>
<p>不同数据库自有不同的恢复指令，简单举 mysql 做个栗子：</p>
<p><code>// 将 dump_girls_db.sql 这个数据库备份，导入到本机 localhost 的 girls_db 数据库中</code></p>
<p><code>// -😂 表示主机名</code></p>
<p><code>// -u 表示用户名，注意这里是 mysql 的用户名而不是 VPS 服务器的用户名</code></p>
<p><code>// -p 表示输入密码</code></p>
<p>$ mysql -hlocalhost -uroot -p girls_db &lt; dump_girls_db.sql</p>
<ul>
<li>启动所需要的服务</li>
</ul>
<p>启动各种服务</p>
<p><code>// 启动各种程序</code></p>
<p>$ service nginx start</p>
<p>$ service php5-fpm start</p>
<p>$ service mysql</p>
<p><code>// 重启和关闭类似</code></p>
<p><code>// service nginx stop</code></p>
<p>作死点：注意新旧机子的系统差异，以及新旧软件的配置差异，比如 ubuntu 系统上装的是 php5-fpm 而在 cent 系统中可能就是 php-fpm，不同系统或者不同版本软件安装后，默认用户、权限可能也不一致。</p>
<p>所以，出了问题应该这么排查：</p>
<ul>
<li>需要的依赖都装完了么</li>
<li>需要的软件都启动正常么，如 $ service nginx status 查看 Nginx 是否运行正常</li>
<li>启动程序的用户和用户组对么，如 $ chown -R userA:group1 &#x2F;data&#x2F; 将 &#x2F;data&#x2F; 的拥有权赋予 group1 用户组中的用户 userA</li>
<li>程序对特定的目录或文件有足够的权限么，如 $ chmod 777 autobackup.sh 给这个 shell 执行权限</li>
<li>知道怎么看各种错误日志么，如 $ tail &#x2F;var&#x2F;log&#x2F;nginx&#x2F;nginx_error.log 查看 nginx 的错误日志</li>
</ul>
<p>到了这里，一家老少都搬回了国内安顿好了，这时候就可以开启下一步了：改善他们的生活。</p>
<h1 id="博客服务器简单优化"><a href="#博客服务器简单优化" class="headerlink" title="博客服务器简单优化"></a><strong>博客服务器简单优化</strong></h1><p>把玩博客只是把玩 VPS 的一个小部分，这里就简单介绍下基于 Wordpress 程序的博客优化过程：</p>
<ul>
<li>删除冗余插件，这个没得说了，清理冗余的不靠谱的插件</li>
<li>批量压缩图片等静态资源文件，配合 gulp&#x2F;grunt 插件使用即可，或使用 wordpress 插件</li>
<li>静态资源 CDN 化，迁移到腾讯云 CDN 上，减轻 HTTP 请求压缩，加快访问速度</li>
<li>开启数据库级别的缓存</li>
<li>开启 PHP 程序级别的缓存</li>
<li>使用 wp-super-cache 插件开启静态页面生成</li>
</ul>
<p>经过简单处理后，博客访问速度大大提升了，当然，还可以继续优化下去。</p>
<p>常访问我们 <a target="_blank" rel="noopener" href="http://www.alloyteam.com/">博客</a> 的朋友，这时候应该能感觉到访问速度有提升吧？欢迎关注我们团队的博文分享。</p>
<h1 id="VPS-数据要备份备份备份！"><a href="#VPS-数据要备份备份备份！" class="headerlink" title="VPS 数据要备份备份备份！"></a><strong>VPS 数据要备份备份备份！</strong></h1><p>不怕一万就怕万一，有数据备份习惯的人总是不会吃亏，这和要有备胎是一样的道理。</p>
<p>需要备份的数据和之前说过要迁移的数据是差不多的，而备份和迁移的区别在于：</p>
<ul>
<li>备份需要定期进行</li>
<li>备份可能需要保留多版本</li>
<li>备份存在多个物理机上最好（异地容灾）</li>
<li>备份有时候需要实时备份（增量传输）</li>
<li>及时删除冗余备份</li>
<li>备份应该切片，方便快速恢复</li>
</ul>
<p>那么，可选的方式是怎样的呢？</p>
<ul>
<li>完整物理机全盘备份，这个需要服务器提供商支持（Linode 支持，而国内云都暂不支持）</li>
<li>使用 ftp 定时备份，需要时可以手动进行（手动肯定不如自动）</li>
<li>使用 rsync 增量安全备份，可以设置多个物理机分时备份（异地容灾）</li>
<li>使用 Dropbox（Dropbox 官方 API 提供，但被墙）</li>
<li>使用 cron + git 的方式定时备份（自定义 cron 定时任务，加上 git 打标签进行版本管理）</li>
</ul>
<p>最优方式是 rsync&#x2F;cron+git 啦，rsync 不再赘述，介绍下 cron+git 方式吧。</p>
<h1 id="cron-自动执行定时任务"><a href="#cron-自动执行定时任务" class="headerlink" title="cron 自动执行定时任务"></a><strong>cron 自动执行定时任务</strong></h1><p>举个栗子，我想要备份一个文件 &#x2F;data&#x2F;sites&#x2F;laiblog&#x2F;content&#x2F;data&#x2F;ghost.db：</p>
<p>要使用 Git 将数据进行自动备份，先编写 &#x2F;data&#x2F;sites&#x2F;laiblog&#x2F;autobackup.sh 脚本</p>
<p><code>#!/bin/sh</code></p>
<p><code># PATH=/opt/someApp/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</code></p>
<p><code># 获取当前时间</code></p>
<p>DATE_ALL&#x3D;<code>date +%Y-%m-%d_%😂.%M.%S</code></p>
<p><code># 切换到 git 项目目录</code></p>
<p>cd &#x2F;data&#x2F;sites&#x2F;laiblog&#x2F;</p>
<p><code># 备份这个 ghost.db 文件</code></p>
<p><code># 注意要指定绝对路径，因为测试时你使用相对路径自然是能执行成功</code></p>
<p><code># 但 cron 执行这个 shell 时，所在的目录和你测试时可能不一致，导致找不到路径</code></p>
<p><code># 添加文件修改</code></p>
<p>git add &#x2F;data&#x2F;sites&#x2F;laiblog&#x2F;content&#x2F;data&#x2F;ghost.db</p>
<p>git commit -m “自动备份”</p>
<p>&#x2F;&#x2F; 推送要远程仓库备份</p>
<p>git push</p>
<p><code># 用时间戳打 tag 并推送到仓库，方便找到这个版本</code></p>
<p><code># v$DATE_ALL 表示以时间为 tag</code></p>
<p>git tag -a v$DATE_ALL -m ‘auto backup’</p>
<p>git push origin v$DATE_ALL:v$DATE_ALL</p>
<p>注意要设置这个文件为可执行模式：</p>
<p>$ chmod 755 &#x2F;data&#x2F;sites&#x2F;laiblog&#x2F;autobackup.sh</p>
<p>再使用 crontab 设置定时任务</p>
<p><code>// 编辑 crontab 任务</code></p>
<p>$ crontab -e</p>
<p>接着在打开的文件中添加：</p>
<p><code># 格式是：m 😂 dom mon dow command</code></p>
<p><code># 即 分钟 小时 日期 月份 周几 命令</code></p>
<p><code># dom 是 day of month</code></p>
<p><code># mon 是 month</code></p>
<p><code># dow 是 day of week</code></p>
<p><code># 如以下：每天凌晨 4 点 59 分执行 autobackup.sh 的脚本</code></p>
<p><code># 2&gt; 表示将错误输出到 crontab-autobackup.log 中，调试时有用</code></p>
<p>59 4 * * * &#x2F;data&#x2F;sites&#x2F;laiblog&#x2F;autobackup.sh 2&gt; &#x2F;data&#x2F;sites&#x2F;laiblog&#x2F;crontab-autobackup.log</p>
<p>注意这个 autoback.sh 脚本使用 git push 时并没有输入帐号密码，是因为设置了全局使用 ssh 连接 git 仓库的方式。</p>
<h1 id="免输入帐号密码使用-git-pull-x2F-push"><a href="#免输入帐号密码使用-git-pull-x2F-push" class="headerlink" title="免输入帐号密码使用 git pull&#x2F;push"></a><strong>免输入帐号密码使用 git pull&#x2F;push</strong></h1><p>使用你的邮箱生成密钥&#x2F;公钥：</p>
<p>$ ssh-keygen -t rsa -b 4096 -C “<a href="mailto:&#x79;&#111;&#x75;&#114;&#95;&#101;&#x6d;&#97;&#x69;&#x6c;&#64;&#x67;&#x6d;&#97;&#x69;&#x6c;&#x2e;&#x63;&#111;&#109;">&#x79;&#111;&#x75;&#114;&#95;&#101;&#x6d;&#97;&#x69;&#x6c;&#64;&#x67;&#x6d;&#97;&#x69;&#x6c;&#x2e;&#x63;&#111;&#109;</a>“</p>
<p>生成后打开 ssh-agent:</p>
<p>$ eval “$(ssh-agent -s)”</p>
<p>将公钥添加到 ssh-agent 中：</p>
<p>ssh-add ~&#x2F;.ssh&#x2F;id_rsa</p>
<p>复制生成的公钥：</p>
<p>$ pbcopy &lt; ~&#x2F;.ssh&#x2F;id_rsa.pub</p>
<p>将公钥添加到 git 仓库的（如 github 的添加地址为：<a target="_blank" rel="noopener" href="https://github.com/settings/ssh">https://github.com/settings/ssh</a>）</p>
<p>修改远程仓库的 url 为 ssh 方式，如：</p>
<p>$ git remote set-url origin <a href="mailto:&#103;&#105;&#x74;&#64;&#x67;&#x69;&#x74;&#104;&#117;&#98;&#x2e;&#99;&#x6f;&#x6d;">&#103;&#105;&#x74;&#64;&#x67;&#x69;&#x74;&#104;&#117;&#98;&#x2e;&#99;&#x6f;&#x6d;</a>:yourUserName&#x2F;yourProjectRepo.git</p>
<p>这么一来，就不用每次 git pull&#x2F;push 都要输入帐号密码了。</p>
<h1 id="使用-VPS-做梯子科学上网？"><a href="#使用-VPS-做梯子科学上网？" class="headerlink" title="使用 VPS 做梯子科学上网？"></a><strong>使用 VPS 做梯子科学上网？</strong></h1><p>对于想饭强锻炼身体科学上网的方法，如果你买的是国外 VPS 比如 <a target="_blank" rel="noopener" href="https://www.linode.com/?r=e815823fd4ebad47aef51ae07250b626d30b7f40">Linode</a>，就可以这么干。</p>
<h2 id="安装-pptpd-搭建-VPN"><a href="#安装-pptpd-搭建-VPN" class="headerlink" title="安装 pptpd 搭建 VPN"></a><strong>安装 pptpd 搭建 VPN</strong></h2><p>按 <a target="_blank" rel="noopener" href="https://help.ubuntu.com/community/PPTPServer">这个教程</a> 走就行了。</p>
<p>注意，在mac上配置 vpn，要把 Send all traffic over VPN connection 勾选上，否则无法正常使用。</p>
<p>设置 mac 在断线后自动重连可参考 <a target="_blank" rel="noopener" href="http://lifehacker.com/5932886/force-mac-os-x-to-automatically-reconnect-to-vpn">这段脚本</a></p>
<p>买个 VPS 搭建个 VPN，其实就省去买 VPN 的钱啦~ 设置多个帐号密码，多用户共享也是爽歪歪~</p>
<h2 id="安装-shadowsocks"><a href="#安装-shadowsocks" class="headerlink" title="安装 shadowsocks"></a><strong>安装 shadowsocks</strong></h2><p>除了使用 pptpd 搭建 VPN，还可以使用 shadowsocks 进行科学上网，更快更便捷，谁用谁知道！</p>
<p>首先在 VPS 上安装服务端：</p>
<p>$ sudo apt-get install python-pip</p>
<p><code>$ pip install shadowsocks</code></p>
<p><code>// 注意以下的 PORT 和 PASSWORD 自定义。</code></p>
<p><code>$ ssserver -p PORT -k PASSWORD -m rc4-md5 -d start</code></p>
<p>如果你是用 mac 的话，安装客户端。</p>
<p>下载 <a target="_blank" rel="noopener" href="http://shadowsocks.org/en/index.html">http://shadowsocks.org/en/index.html</a></p>
<p>设置：</p>
<p>服务器地址为 VPS 的 id，</p>
<p>端口为上面设定的 PORT，</p>
<p>密码为上面设定的 PASSWORD，</p>
<p>加密方式为上面设定的 rc4-md5</p>
<p>然后就可以科学上网了。</p>
<p>以上设置了一个 PORT 和 PASSWARD 也就只是单用户上网，如果设置多用户的话，维护 &#x2F;etc&#x2F;shadowsocks.json：</p>
<p>{</p>
<p>“server”:”VPS服务器的IP”,</p>
<p>“local_address”: “127.0.0.1”,</p>
<p>“local_port”:1080,</p>
<p>“port_password”:{</p>
<p>&#x2F;&#x2F; 设置多个用户</p>
<p>“9000”:”PASSWORD9000”,</p>
<p>“9001”:”PASSWORD9001”,</p>
<p>“9002”:”PASSWORD9002”,</p>
<p>“9003”:”PASSWORD9003”,</p>
<p>“9004”:”PASSWORD9004”</p>
<p>},</p>
<p>“timeout”:300,</p>
<p>“method”:”rc4-md5”,</p>
<p>“fast_open”: false</p>
<p>}</p>
<p>额，最近 ss 的作者被约谈了，日后还能不能用也是未知也是难。。。</p>
<h1 id="VPS-折腾总结"><a href="#VPS-折腾总结" class="headerlink" title="VPS 折腾总结"></a><strong>VPS 折腾总结</strong></h1><ul>
<li>不作死就不会死，Linux 中用户和权限相关的知识非常重要，这往往决定了程序是否能够正常运行以及服务器是否安全。</li>
<li>边折腾边学习，掌握问题背后的原因。</li>
<li>学习到很好有趣的命令，比如：</li>
</ul>
<p><code>// 查看硬盘（剩余）空间</code></p>
<p>$ df -😂</p>
<p><code>// 查看文件夹占用空间</code></p>
<p><code>// -d 表示计算 1 层目录，利用这个我们可以从根目录开始执行这个指令，层层下去查看到底是哪里占用了太多空间以瘦身</code></p>
<p>$ du -😂 -d 1</p>
<p><code>// 查看特定文件并计算数量</code></p>
<p><code>// find ./ 表示在当前目录开始查找</code></p>
<p><code>// -name &quot;*.png&quot; 表示查找以 .png 为后缀的文件</code></p>
<p><code>// | 是 *nix 中流式传输的思想，意为将前面程序的输出结果，当作后续程序的输入源</code></p>
<p><code>// wc -l 表示计算数量，并将其列出</code></p>
<p>$ find .&#x2F; -name “*.png” | wc -l</p>
<p><a target="_blank" rel="noopener" href="http://www.alloyteam.com/2015/08/vps-notes/">原文链接</a></p>
<p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000003480980">2015年08月22日发布</a></p>

  </div>
  <div>
    
      <div 
        class="post-note note-warning copyright" 
        style="margin-top: 42px">
        <p>
          <span style="font-weight: bold;">作者：</span><a 
            target="_blank" 
            rel="nofollow noopener noreferrer" 
            href="/about">
            潜
          </a>
        </p>
        <p>
          <span style="font-weight: bold;">文章链接：</span><a 
            target="_blank" 
            rel="nofollow noopener noreferrer" 
            href="http://blog.779911.xyz/2020/07/29/vps%E6%8D%A3%E9%BC%93%E5%B0%8F%E8%AE%B0/">
            http://blog.779911.xyz/2020/07/29/vps%E6%8D%A3%E9%BC%93%E5%B0%8F%E8%AE%B0/
          </a>
        </p>
        <p><span style="font-weight: bold;">版权声明：</span>本博客所有文章除特别声明外，均采用<a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0 协议</a>。转载请注明出处！</p>
      </div>
    
  </div>
</article>
<div class="nav">
  
    <div class="nav-item-prev">
      <a 
        href="/2020/07/31/%E7%A2%8E%E7%89%87%E5%8C%96%E9%98%85%E8%AF%BB%E6%B5%81%E7%A8%8B/" 
        class="nav-link">
        <i class="iconfont icon-left nav-prev-icon"></i>
        <div>
          <div class="nav-label">Prev</div>
          
            <div class="nav-title">碎片化阅读流程 </div>
          
        </div>
      </a>
    </div>
  
  
    <div class="nav-item-next">
      <a 
        href="/2020/07/28/%E5%85%B6%E4%BB%96%E4%B9%A6%E6%91%98/" 
        class="nav-link">
        <div>
          <div class="nav-label">Next</div>
          
            <div class="nav-title">其他书摘 </div>
          
        </div>
        <i class="iconfont icon-right nav-next-icon"></i>
      </a>
    </div>
  
</div>

<div 
  class="card card-content toc-card" 
  id="mobiletoc">
  <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>TOC
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%8E%E8%B4%AD%E4%B9%B0%E4%B8%80%E4%B8%AA-VPS-%E5%BC%80%E5%A7%8B"><span class="toc-text">从购买一个 VPS 开始</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%AE%9E%E6%88%98%EF%BC%8C%E8%AF%95%E6%89%8B-VPS-%E8%BF%81%E7%A7%BB"><span class="toc-text">快速实战，试手 VPS 迁移</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VPS-%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB"><span class="toc-text">VPS 数据迁移</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VPS-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%B8%8E%E6%81%A2%E5%A4%8D"><span class="toc-text">VPS 环境搭建与恢复</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%9A%E5%AE%A2%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%80%E5%8D%95%E4%BC%98%E5%8C%96"><span class="toc-text">博客服务器简单优化</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VPS-%E6%95%B0%E6%8D%AE%E8%A6%81%E5%A4%87%E4%BB%BD%E5%A4%87%E4%BB%BD%E5%A4%87%E4%BB%BD%EF%BC%81"><span class="toc-text">VPS 数据要备份备份备份！</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#cron-%E8%87%AA%E5%8A%A8%E6%89%A7%E8%A1%8C%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1"><span class="toc-text">cron 自动执行定时任务</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%8D%E8%BE%93%E5%85%A5%E5%B8%90%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BD%BF%E7%94%A8-git-pull-x2F-push"><span class="toc-text">免输入帐号密码使用 git pull&#x2F;push</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-VPS-%E5%81%9A%E6%A2%AF%E5%AD%90%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%EF%BC%9F"><span class="toc-text">使用 VPS 做梯子科学上网？</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-pptpd-%E6%90%AD%E5%BB%BA-VPN"><span class="toc-text">安装 pptpd 搭建 VPN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-shadowsocks"><span class="toc-text">安装 shadowsocks</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VPS-%E6%8A%98%E8%85%BE%E6%80%BB%E7%BB%93"><span class="toc-text">VPS 折腾总结</span></a></li></ol>
</div>
            </main>
            <aside class="right-column">
              <div class="sticky-widescreen">
  
  
    <article class="card card-content toc-card">
      <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>TOC
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%8E%E8%B4%AD%E4%B9%B0%E4%B8%80%E4%B8%AA-VPS-%E5%BC%80%E5%A7%8B"><span class="toc-text">从购买一个 VPS 开始</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%AE%9E%E6%88%98%EF%BC%8C%E8%AF%95%E6%89%8B-VPS-%E8%BF%81%E7%A7%BB"><span class="toc-text">快速实战，试手 VPS 迁移</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VPS-%E6%95%B0%E6%8D%AE%E8%BF%81%E7%A7%BB"><span class="toc-text">VPS 数据迁移</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VPS-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%B8%8E%E6%81%A2%E5%A4%8D"><span class="toc-text">VPS 环境搭建与恢复</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%9A%E5%AE%A2%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AE%80%E5%8D%95%E4%BC%98%E5%8C%96"><span class="toc-text">博客服务器简单优化</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VPS-%E6%95%B0%E6%8D%AE%E8%A6%81%E5%A4%87%E4%BB%BD%E5%A4%87%E4%BB%BD%E5%A4%87%E4%BB%BD%EF%BC%81"><span class="toc-text">VPS 数据要备份备份备份！</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#cron-%E8%87%AA%E5%8A%A8%E6%89%A7%E8%A1%8C%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1"><span class="toc-text">cron 自动执行定时任务</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%8D%E8%BE%93%E5%85%A5%E5%B8%90%E5%8F%B7%E5%AF%86%E7%A0%81%E4%BD%BF%E7%94%A8-git-pull-x2F-push"><span class="toc-text">免输入帐号密码使用 git pull&#x2F;push</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-VPS-%E5%81%9A%E6%A2%AF%E5%AD%90%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%EF%BC%9F"><span class="toc-text">使用 VPS 做梯子科学上网？</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-pptpd-%E6%90%AD%E5%BB%BA-VPN"><span class="toc-text">安装 pptpd 搭建 VPN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-shadowsocks"><span class="toc-text">安装 shadowsocks</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#VPS-%E6%8A%98%E8%85%BE%E6%80%BB%E7%BB%93"><span class="toc-text">VPS 折腾总结</span></a></li></ol>
    </article>
  
  
  <article class="card card-content">
    <div class="recent-posts-card">
  <div class="recent-posts-header">
    <i 
      class="iconfont icon-wenzhang_huaban" 
      style="padding-right: 2px;">
    </i>Recent Posts
  </div>
  <div class="recent-posts-list">
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2023-04-12</div>
        <a href="/2023/04/12/%E8%B6%85%E7%BA%A7%E6%96%B9%E4%BE%BF%E7%9A%84linux%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C/"><div class="recent-posts-item-content"></div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2023-04-12</div>
        <a href="/2023/04/12/%E8%B0%88%E5%88%A4%E6%8A%80%E5%B7%A7/"><div class="recent-posts-item-content"></div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2023-04-12</div>
        <a href="/2023/04/12/%E7%94%A8%E6%88%B7%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%E8%8C%83%E6%96%87%E5%92%8C%E7%BB%83%E4%B9%A0/"><div class="recent-posts-item-content"></div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2023-04-12</div>
        <a href="/2023/04/12/%E6%B4%BB%E5%87%BA%E6%9B%B4%E5%A5%BD%E7%9A%84%E8%87%AA%E5%B7%B1/"><div class="recent-posts-item-content"></div></a>
      </div>
    
  </div>
</div>
  </article>
  
  
</div>
            </aside>
          </div>
        </div>
      </div>
    </div>
     
    <footer class="footer">
  <div class="footer-container">
    <div>
      <div class="footer-dsc">
        <span>
          Copyright ©
          
            2020
          
          
                - 
                2023
          
        </span>
        &nbsp;
        <a 
          href="/" 
          class="footer-link">
          潜空间
        </a>
      </div>
    </div>

    
      <div class="footer-dsc">
        
          Powered by
          <a 
            href="https://hexo.io/" 
            class="footer-link" 
            target="_blank" 
            rel="nofollow noopener noreferrer">
            &nbsp;Hexo
          </a>
        
        
          <span>&nbsp;|&nbsp;</span>
        
        
          Theme -
          <a 
            href="https://github.com/theme-kaze" 
            class="footer-link" 
            target="_blank"
            rel="nofollow noopener noreferrer">
            &nbsp;Kaze
          </a>
        
      </div>
    
    
    
    
</footer>
 
    
  <a 
    role="button" 
    id="scrollbutton" 
    class="basebutton" 
    aria-label="回到顶部">
    <i class="iconfont icon-arrowleft button-icon"></i>
  </a>

<a 
  role="button" 
  id="menubutton"
  aria-label="menu button"
  class="basebutton">
  <i class="iconfont icon-menu button-icon"></i>
</a>
<a 
  role="button" 
  id="popbutton" 
  class="basebutton" 
  aria-label="控制中心">
  <i class="iconfont icon-expand button-icon"></i>
</a>
<a 
  role="button" 
  id="darkbutton" 
  class="basebutton darkwidget" 
  aria-label="夜色模式">
  <i class="iconfont icon-weather button-icon"></i>
</a>
<a 
  role="button" 
  id="searchbutton" 
  class="basebutton searchwidget" 
  aria-label="搜索">
  <i class="iconfont icon-search button-icon"></i>
</a> 
     
     
     
      <script>
  var addImgLayout = function () {
    var img = document.querySelectorAll('.post-content img')
    var i
    for (i = 0; i < img.length; i++) {
      var wrapper = document.createElement('a')
      wrapper.setAttribute('href', img[i].getAttribute('data-src'))
      wrapper.setAttribute('aria-label', 'illustration')
      wrapper.style.cssText =
        'width: 100%; display: flex; justify-content: center;'
      if (img[i].alt) wrapper.dataset.caption = img[i].alt
      wrapper.dataset.nolink = true
      img[i].before(wrapper)
      wrapper.append(img[i])
      var divWrap = document.createElement('div')
      divWrap.classList.add('gallery')
      wrapper.before(divWrap)
      divWrap.append(wrapper)
    }
    baguetteBox.run('.gallery')
  }
</script>
<script>
  loadScript(
    "/js/lib/lightbox/baguetteBox.min.js",
    addImgLayout
  )
</script>
 
     
     
    <script src="/js/main.js"></script> 
     
    
      <script>
        var addLazyload = function () {
          var observer = lozad('.lozad', {
            load: function (el) {
              el.srcset = el.getAttribute('data-src')
            },
            loaded: function (el) {
              el.classList.add('loaded')
            },
          })
          observer.observe()
        }
      </script>
      <script>
        loadScript('/js/lib/lozad.min.js', addLazyload)
      </script>
    
    <script src="//instant.page/5.1.0" type="module"
      integrity="sha384-by67kQnR+pyfy8yWP4kPO12fHKRLHZPfEsiSXR8u2IKcTdxD805MGUXBzVPnkLHw"></script>
    
    
  </body>
</html>
